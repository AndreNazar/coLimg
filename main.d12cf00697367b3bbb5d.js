(()=>{"use strict";var e=document.querySelector(".delete-block"),t=document.querySelector(".container .output_colors"),n=document.querySelector(".container .output_img"),r=document.querySelector(".container .main-title"),o=document.querySelector(".form-container"),a=document.querySelector(".form input"),i=document.querySelector(".form .text"),c=document.querySelector(".up-icon");const u=function(){function e(){}return e.prototype.euclideanDistance=function(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))},e.prototype.findClosestCentroid=function(e,t){var n=this,r=Number.MAX_VALUE,o=null;return t.forEach((function(t){var a=n.euclideanDistance(e,t);a<r&&(r=a,o=t)})),o},e.prototype.updateCentroids=function(e){return e.map((function(e){if(0===e.length)return[0,0,0];var t=e.reduce((function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]}),[0,0,0]);return[t[0]/e.length,t[1]/e.length,t[2]/e.length]}))},e.prototype.cluster=function(e,t,n){var r=this;void 0===n&&(n=100);for(var o=e.slice(0,t),a=new Array(t).fill(null).map((function(){return[]})),i=function(n){a=new Array(t).fill(null).map((function(){return[]})),e.forEach((function(e){var t=r.findClosestCentroid(e,o),n=o.indexOf(t);a[n].push(e)}));var i=c.updateCentroids(a);if(o.every((function(e,t){return r.euclideanDistance(e,i[t])<1})))return"break";o=i},c=this,u=0;u<n&&"break"!==i();u++);return a},e}();var l=function(e,t){e.preventDefault(),i.innerHTML={over:"Отпустите изображение, чтобы начать загрузку",leave:"Нажмите, чтобы выбрать картинку, либо перетащите картинку сюда"}[t],"over"===t?c.classList.add("active"):c.classList.remove("active")},s=function(e){var t=new Image;if(1===e.length&&("image/png"===e[0].type||"image/jpeg"===e[0].type||"image/svg+xml"===e[0].type)){o.classList.remove("load-animation");var r=setTimeout((function(){o.style.display="none",n.innerHTML="",t.src=URL.createObjectURL(e[0]),t.onload=function(e){return function(){var t,n=document.createElement("canvas"),r=n.getContext("2d"),o=new u,a=[];n.width=e.naturalWidth,n.height=e.naturalHeight,r.drawImage(e,0,0,e.naturalWidth,e.naturalHeight),t=r.getImageData(0,0,e.naturalWidth,e.naturalHeight).data;for(var i=0;i<t.length;i+=4)a.push([t[i],t[i+1],t[i+2]]);o.cluster(a,3).map((function(e){return o.updateCentroids([e])[0]})).forEach((function(e){return f(e)})),d()}}(t),n.appendChild(t),clearTimeout(r)}),600)}},d=function(){return t=void 0,r=void 0,a=function(){var t;return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}}(this,(function(r){return n.classList.add("load-animation"),document.querySelectorAll(".container .output_colors .color-block").forEach((function(t,n){var r=setTimeout((function(){t.classList.add("load-animation"),2===n&&(e.style.display="flex"),clearTimeout(r)}),100*(n+1))})),t=setTimeout((function(){e.classList.add("load-animation"),clearTimeout(t)}),400),[2]}))},new((o=void 0)||(o=Promise))((function(e,n){function i(e){try{u(a.next(e))}catch(e){n(e)}}function c(e){try{u(a.throw(e))}catch(e){n(e)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(i,c)}u((a=a.apply(t,r||[])).next())}));var t,r,o,a},f=function(e){var n=document.createElement("div"),r=document.createElement("p"),o=e[0],a=e[1],i=e[2],c=(299*o+587*a+114*i)/1e3;r.className="color-text",r.innerHTML="#"+p(o)+p(a)+p(i),r.style.color=c>128?"#000":"#fff",n.className="color-block",n.style.backgroundColor="rgb(".concat(o,", ").concat(a,", ").concat(i,")");var u=document.createElement("div");u.className="copied_alert",u.innerHTML="Copied!",n.appendChild(u),t.appendChild(n),n.appendChild(r),n.addEventListener("click",(function(){return m(u,r)}))},m=function(e,t){var n=null;e.style.display="flex",n=setTimeout((function(){return e.classList.add("active")})),n=setTimeout((function(){e.classList.remove("active"),n=setTimeout((function(){e.style.display="none",clearTimeout(n)}),300)}),500),navigator.clipboard.writeText(t.innerHTML)},p=function(e){return 1===(+e.toFixed()).toString(16).length?"0"+(+e.toFixed()).toString(16):(+e.toFixed()).toString(16)};document.addEventListener("DOMContentLoaded",(function(){var e;e=setTimeout((function(){o.classList.add("load-animation"),r.classList.add("load-animation"),clearTimeout(e)}),400)})),a.addEventListener("dragover",(function(e){return l(e,"over")})),a.addEventListener("dragleave",(function(e){return l(e,"leave")})),a.addEventListener("drop",(function(e){l(e,"leave"),s(e.dataTransfer.files)})),a.addEventListener("change",(function(e){e.preventDefault(),s(e.target.files)})),e.addEventListener("click",(function(){return function(){e.classList.remove("load-animation"),n.classList.remove("load-animation"),document.querySelectorAll(".container .output_colors .color-block").forEach((function(e){return e.classList.remove("load-animation")})),o.style.display="grid",a.value="";var r=setTimeout((function(){o.classList.add("load-animation"),n.innerHTML="",t.innerHTML="",e.style.display="none",clearTimeout(r)}),400)}()}))})();